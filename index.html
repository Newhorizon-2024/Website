<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Horizon</title>

    <!-- 图标设置 -->
    <link rel="icon" href="icons/favicon-16x16.png" sizes="16x16" type="image/png">
    <link rel="icon" href="icons/favicon-32x32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="icons/favicon-48x48.png" sizes="48x48" type="image/png">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon-180x180.png" sizes="180x180">
    <link rel="icon" href="icons/android-chrome-192x192.png" sizes="192x192" type="image/png">
    <meta name="msapplication-TileImage" content="icons/mstile-144x144.png">
    <link rel="icon" href="icons/icon-96x96.png" sizes="96x96" type="image/png">
    <link rel="icon" href="icons/icon-128x128.png" sizes="128x128" type="image/png">
    <link rel="icon" href="icons/icon-256x256.png" sizes="256x256" type="image/png">
    <link rel="icon" href="icons/icon-384x384.png" sizes="384x384" type="image/png">
    <link rel="icon" href="icons/icon-512x512.png" sizes="512x512" type="image/png">

    <!-- 样式 -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow-y: auto; /* 启用垂直滚动条 */
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(120deg, #000000, #434343);
            color: white;
        }
        #content {
            min-height: 100vh; /* 让content部分至少占满一个视窗高度 */
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            position: relative;
            z-index: 2;
        }
        #background-3d {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        #music-sensor, #fullscreen-sensor, #scrollbar-sensor, #language-sensor {
            position: fixed;
            width: 50px; /* 缩小感应区域的宽度 */
            height: 100px; /* 缩小感应区域的高度 */
            z-index: 1000;
            cursor: pointer;
            background-color: transparent;
        }
        #music-sensor {
            bottom: 10px;
            left: 0;
        }
        #fullscreen-sensor {
            bottom: 10px;
            right: 0;
        }
        #scrollbar-sensor {
            bottom: 220px;
            right: 0;
        }
        #language-sensor {
            top: 10px;
            right: 0;
        }
        #music-controls, #fullscreen-controls, #scrollbar-controls, #language-controls {
            position: fixed;
            backdrop-filter: blur(5px); /* 毛玻璃效果减弱一倍 */
            background-color: rgba(40, 40, 40, 0.9); /* 深灰色背景 */
            color: white;
            border: none;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease-out, left 0.3s ease-out, right 0.3s ease-out;
            z-index: 1001;
            border-radius: 5px; /* 圆角边框减弱一倍 */
        }
        #music-controls {
            left: -250px;
            bottom: 10px;
            width: 400px;  /* 增加宽度 */
            height: 200px; /* 增加高度，确保文本和图标不重叠 */
        }
        #fullscreen-controls {
            right: -150px;
            bottom: 10px;
        }
        #scrollbar-controls {
            right: -150px;
            bottom: 220px;
        }
        #language-controls {
            right: -150px;
            top: 10px;
        }

        /* 音乐控制按钮样式 */
        #music-controls button {
            color: #b0b0b0;
            background: none;
            border: none;
            padding: 5px;
            cursor: pointer;
            font-size: 2rem; /* 增大按钮字体尺寸 */
            outline: none; /* 移除按钮的默认高亮框 */
        }

        #music-controls button:hover {
            color: #d0d0d0;
        }

        /* 音乐控制部件显示 */
        #music-controls-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 350px;
            margin-top: 20px; /* 增加上方空隙，确保按钮在文本下方 */
        }

        #music-song-info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
        }

        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 3;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            opacity: 1;
            transition: opacity 2s ease-in-out;
            pointer-events: auto; /* 确保点击事件可以被触发 */
        }
        #overlay h2 {
            color: white;
            font-size: 3vw;
            font-family: 'Roboto', sans-serif;
            white-space: nowrap;
            z-index: 2;
        }
        #welcome-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Roboto', sans-serif;
            opacity: 0;
            transition: opacity 2.5s ease-in-out;
            white-space: nowrap;
            z-index: 2;
            font-size: 3vw;
        }
        #countdown {
            position: relative;
            margin: 20px auto 0 auto;
            text-align: center;
            font-family: 'Roboto', sans-serif;
            opacity: 0;
            transition: opacity 2.5s ease-in-out;
            white-space: nowrap;
            z-index: 2;
            font-size: 4vw;
        }
        #about-section {
            position: relative; /* 保持原有定位 */
            height: auto; /* 自动调整高度 */
            width: 80%;  /* 调整宽度 */
            background-color: rgba(40, 40, 40, 0.9); /* 深灰色背景 */
            backdrop-filter: blur(5px); /* 毛玻璃效果减弱一倍 */
            color: white;
            padding: 20px;
            text-align: center;
            font-family: 'Roboto', sans-serif; /* 使用与其他文本相同的字体 */
            font-size: 1.5vw; /* 缩小文字尺寸 */
            line-height: 1.5; /* 增加行高 */
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 50px auto; /* 居中 */
            z-index: 2; /* 确保about-section不会被方块遮住 */
            flex-direction: column; /* 使文字居中显示 */
            border-radius: 5px; /* 圆角边框减弱一倍 */
        }
        #about-section h1 {
            font-size: 2vw;
            margin-bottom: 20px;
            font-weight: bold;
        }
        #about-section p {
            margin: 0;
            text-align: center;
            word-wrap: break-word;
        }

        #statement-section {
            position: relative;
            height: auto; /* 自动调整高度 */
            width: 80%;  /* 调整宽度 */
            background-color: rgba(40, 40, 40, 0.9); /* 深灰色背景 */
            backdrop-filter: blur(5px); /* 毛玻璃效果减弱一倍 */
            color: white;
            padding: 20px;
            text-align: center;
            font-family: 'Roboto', sans-serif;
            font-size: 1.5vw;
            line-height: 1.5;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 50px auto;
            z-index: 2;
            flex-direction: column;
            border-radius: 5px;
        }
        #statement-section h1 {
            font-size: 2vw;
            margin-bottom: 20px;
            font-weight: bold;
        }
        #statement-section p {
            margin: 0;
            text-align: center;
            word-wrap: break-word;
        }

        #qr-code {
            display: block;
            margin: 20px auto;
            width: 150px;
            height: 150px;
            z-index: 3; /* 二维码的z-index为3 */
        }

        /* Media query for smaller screens */
        @media (max-width: 600px) {
            #overlay h2 {
                font-size: 6vw;
            }
            #welcome-message {
                font-size: 5vw;
            }
            #countdown {
                font-size: 6vw;
            }
            #about-section, #statement-section {
                font-size: 3.5vw;
                padding: 15px;
            }
            #about-section h1, #statement-section h1 {
                font-size: 4vw;
            }
        }
    </style>
</head>
<body>
    <canvas id="background-3d"></canvas>
    
    <div id="content">
        <audio id="background-music" loop>
            <source src="media/loki.flac" type="audio/flac">
        </audio>
        <div id="music-sensor" onmouseenter="showMusicControls()" onmouseleave="hideMusicControls()"></div>
        <div id="music-controls" onmouseenter="clearHideTimeout()" onmouseleave="hideMusicControls()">
            <div id="music-song-info">歌曲: 无名曲<br>歌手: 未知艺术家</div>
            <div id="music-controls-bar">
                <button id="playlist-button">≡</button>
                <button id="prev-button">◁</button>
                <button id="play-button" onclick="togglePlayPause()">∥</button>
                <button id="next-button">▷</button>
                <button id="play-mode-button" onclick="togglePlayMode()">⥤</button>
            </div>
        </div>
        <div id="fullscreen-sensor" onmouseenter="showFullscreenControls()" onmouseleave="hideFullscreenControls()"></div>
        <div id="fullscreen-controls" onmouseenter="clearHideTimeoutFullscreen()" onmouseleave="hideFullscreenControls()">
            <button onclick="toggleFullScreen()">全屏</button>
        </div>
        <div id="scrollbar-sensor" onmouseenter="showScrollbarControls()" onmouseleave="hideScrollbarControls()"></div>
        <div id="scrollbar-controls" onmouseenter="clearHideTimeoutScrollbar()" onmouseleave="hideScrollbarControls()">
            <button id="scrollbar-button" onclick="toggleScrollbar()">隐藏滚动条</button>
        </div>
        <div id="language-sensor" onmouseenter="showLanguageControls()" onmouseleave="hideLanguageControls()"></div>
        <div id="language-controls" onmouseenter="clearHideTimeoutLanguage()" onmouseleave="hideLanguageControls()">
            <button id="language-button" onclick="toggleLanguage()">切换语言</button>
        </div>
        <div id="overlay" onclick="startExperience()">
            <h2>Click to start.</h2>
        </div>
        <div id="welcome-message">Welcome to the New Horizon.</div>
        <div id="countdown"></div>
    </div>

    <div id="about-section">
        <h1>关于 New Horizon</h1>
        <p>New Horizon 是一个为娱乐而生的数字平台，旨在通过创意与技术的结合，为用户提供一个自由表达、成长、以及尽可能解决情绪的空间。相信娱乐不仅是放松的方式，更是探索和开拓自我的重要途径。</p>
        <p>无论灰烬，相信每一个灵感火花都值得被点燃，每一个故事都值得被倾听。在这里，用户不仅仅是观众，更是缔造者。我们鼓励每一个人释放自己的创意，通过多种形式展示和分享自己的作品。社区是一个充满活力的交流平台，汇聚来自世界各地的创作者和思想家。你可以与志同道合的人们交流想法，获得反馈，并取得成长、能力提升或任何可能的进步及延伸。</p>
        <p>无论你是探寻放松身心，还是寻求灵感，希望这里能够成为你的理想地，一片港湾。</p>
        <img id="qr-code" src="images/interact-qr-code.png" alt="群二维码">
    </div>

    <div id="statement-section">
        <h1>声明</h1>
        <p>New Horizon 致力于创建一个和谐、尊重与包容的社区，所有内容和服务都应遵循和平共处的原则。我们希望每一位用户在享受平台提供的创意空间时，也能以尊重和理解的态度对待他人。</p>
        <p>如需提出涉及当地法律的纠纷，请直接发律师函至我们指定的地址，与相关方迅速沟通，确保在法律框架内尽快解决争议。</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let hideTimeout;
        let hideFullscreenTimeout;
        let hideScrollbarTimeout;
        let hideLanguageTimeout;
        let scrollbarEnabled = true;
        let isEnglish = false;
        let isPlaying = true;
        let playModes = ["⥤", "⇌", "∞"];
        let currentPlayModeIndex = 0;

        function showMusicControls() {
            const controls = document.getElementById('music-controls');
            controls.style.left = '10px';
            controls.style.opacity = '1';
        }

        function hideMusicControls() {
            hideTimeout = setTimeout(() => {
                const controls = document.getElementById('music-controls');
                controls.style.left = '-250px';
                controls.style.opacity = '0';
            }, 1000);
        }

        function clearHideTimeout() {
            clearTimeout(hideTimeout);
        }

        function togglePlayPause() {
            const playButton = document.getElementById('play-button');
            if (isPlaying) {
                playButton.textContent = "▶"; // 切换到播放符号
            } else {
                playButton.textContent = "∥"; // 切换到暂停符号
            }
            isPlaying = !isPlaying; // 切换状态
        }

        // 切换播放模式
        function togglePlayMode() {
            const playModeButton = document.getElementById('play-mode-button');
            currentPlayModeIndex = (currentPlayModeIndex + 1) % playModes.length;
            playModeButton.textContent = playModes[currentPlayModeIndex]; // 更新播放模式符号
        }

        function showFullscreenControls() {
            const controls = document.getElementById('fullscreen-controls');
            controls.style.right = '10px';
            controls.style.opacity = '1';
        }

        function hideFullscreenControls() {
            hideFullscreenTimeout = setTimeout(() => {
                const controls = document.getElementById('fullscreen-controls');
                controls.style.right = '-150px';
                controls.style.opacity = '0';
            }, 1000);
        }

        function clearHideTimeoutFullscreen() {
            clearTimeout(hideFullscreenTimeout);
        }

        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }

        function showScrollbarControls() {
            const controls = document.getElementById('scrollbar-controls');
            controls.style.right = '10px';
            controls.style.opacity = '1';
        }

        function hideScrollbarControls() {
            hideScrollbarTimeout = setTimeout(() => {
                const controls = document.getElementById('scrollbar-controls');
                controls.style.right = '-150px';
                controls.style.opacity = '0';
            }, 1000);
        }

        function clearHideTimeoutScrollbar() {
            clearTimeout(hideScrollbarTimeout);
        }

        function toggleScrollbar() {
            const body = document.body;
            const scrollbarButton = document.getElementById('scrollbar-button');
            scrollbarEnabled = !scrollbarEnabled;
            body.style.overflowY = scrollbarEnabled ? 'auto' : 'hidden';
            scrollbarButton.textContent = scrollbarEnabled ? "隐藏滚动条" : "显示滚动条";
        }

        function showLanguageControls() {
            const controls = document.getElementById('language-controls');
            controls.style.right = '10px';
            controls.style.opacity = '1';
        }

        function hideLanguageControls() {
            hideLanguageTimeout = setTimeout(() => {
                const controls = document.getElementById('language-controls');
                controls.style.right = '-150px';
                controls.style.opacity = '0';
            }, 1000);
        }

        function clearHideTimeoutLanguage() {
            clearTimeout(hideLanguageTimeout);
        }

        function toggleLanguage() {
            isEnglish = !isEnglish;
            document.getElementById('play-button').textContent = isEnglish ? "Play" : "∥";
            document.getElementById('fullscreen-controls').querySelector('button').textContent = isEnglish ? "Fullscreen" : "全屏";
            document.getElementById('scrollbar-button').textContent = scrollbarEnabled ? (isEnglish ? "Hide Scrollbar" : "隐藏滚动条") : (isEnglish ? "Show Scrollbar" : "显示滚动条");
            document.getElementById('language-button').textContent = isEnglish ? "Switch Language" : "切换语言";
            document.querySelector('#about-section h1').textContent = isEnglish ? "About New Horizon" : "关于 New Horizon";
            document.querySelector('#about-section p:nth-of-type(1)').textContent = isEnglish ?
                "New Horizon is a digital platform born for entertainment, aiming to provide users with a space for free expression, growth, and emotional relief through the combination of creativity and technology. We believe that entertainment is not just a way to relax, but also an important way to explore and expand oneself." :
                "New Horizon 是一个为娱乐而生的数字平台，旨在通过创意与技术的结合，为用户提供一个自由表达、成长、以及尽可能解决情绪的空间。相信娱乐不仅是放松的方式，更是探索和开拓自我的重要途径。";
            document.querySelector('#about-section p:nth-of-type(2)').textContent = isEnglish ?
                "No matter the ashes, we believe that every spark of inspiration deserves to be ignited, and every story deserves to be heard. Here, users are not just spectators, but creators. We encourage everyone to unleash their creativity, showcase, and share their works in various forms. The community is a vibrant exchange platform that brings together creators and thinkers from around the world. You can exchange ideas with like-minded people, receive feedback, and achieve growth, skill enhancement, or any possible progress and extension." :
                "无论灰烬，相信每一个灵感火花都值得被点燃，每一个故事都值得被倾听。在这里，用户不仅仅是观众，更是缔造者。我们鼓励每一个人释放自己的创意，通过多种形式展示和分享自己的作品。社区是一个充满活力的交流平台，汇聚来自世界各地的创作者和思想家。你可以与志同道合的人们交流想法，获得反馈，并取得成长、能力提升或任何可能的进步及延伸。";
            document.querySelector('#about-section p:nth-of-type(3)').textContent = isEnglish ?
                "Whether you're seeking to relax or seeking inspiration, we hope this place can become your ideal place, a haven." :
                "无论你是探寻放松身心，还是寻求灵感，希望这里能够成为你的理想地，一片港湾。";
            document.querySelector('#statement-section h1').textContent = isEnglish ? "Statement" : "声明";
            document.querySelector('#statement-section p:nth-of-type(1)').textContent = isEnglish ?
                "New Horizon is committed to creating a harmonious, respectful, and inclusive community, where all content and services must adhere to the principle of peaceful coexistence. We hope that every user, while enjoying the creative space provided by the platform, will also treat others with respect and understanding." :
                "New Horizon 致力于创建一个和谐、尊重与包容的社区，所有内容和服务都应遵循和平共处的原则。我们希望每一位用户在享受平台提供的创意空间时，也能以尊重和理解的态度对待他人。";
            document.querySelector('#statement-section p:nth-of-type(2)').textContent = isEnglish ?
                "If you need to raise a dispute involving local laws, please send a lawyer's letter directly to our designated address, and communicate with the relevant parties quickly to ensure that the dispute is resolved as soon as possible within the legal framework." :
                "如需提出涉及当地法律的纠纷，请直接发律师函至我们指定的地址，与相关方迅速沟通，确保在法律框架内尽快解决争议。";
        }

        function startExperience() {
            const audio = document.getElementById('background-music');
            audio.play();

            const overlayElement = document.getElementById('overlay');
            overlayElement.style.opacity = 0;
            setTimeout(() => {
                overlayElement.style.display = 'none';
                showWelcomeMessage();
            }, 2000);
        }

        function showWelcomeMessage() {
            const welcomeMessage = document.getElementById('welcome-message');
            welcomeMessage.style.opacity = 1;
            setTimeout(() => {
                setTimeout(() => {
                    welcomeMessage.style.opacity = 0;
                    setTimeout(() => {
                        showCountdown();
                    }, 2500);
                }, 1000); // Pause for 1 second before fading out
            }, 2500); // Fade in duration
        }

        function showCountdown() {
            const countdownElement = document.getElementById('countdown');
            countdownElement.style.opacity = 1;
            setInterval(updateCountdown, 1000);
        }

        function updateCountdown() {
            const countdownElement = document.getElementById('countdown');
            const startDate = new Date('2024-06-19T00:00:00');
            const now = new Date();
            const elapsedTime = now - startDate;

            const days = String(Math.floor(elapsedTime / (1000 * 60 * 60 * 24))).padStart(2, '0');
            const hours = String(Math.floor((elapsedTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))).padStart(2, '0');
            const minutes = String(Math.floor((elapsedTime % (1000 * 60 * 60)) / (1000 * 60))).padStart(2, '0');
            const seconds = String(Math.floor((elapsedTime % (1000 * 60)) / 1000)).padStart(2, '0');

            countdownElement.textContent = `${days}:${hours}:${minutes}:${seconds}`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('overlay').addEventListener('click', startExperience, { once: true });
        });

        const canvas = document.getElementById('background-3d');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);

        const light = new THREE.DirectionalLight(0xffffff, 1);
        light.position.set(5, 5, 5).normalize();
        light.castShadow = true; // 启用阴影
        light.shadow.mapSize.width = 1024; // 调整阴影质量
        light.shadow.mapSize.height = 1024;
        light.shadow.camera.near = 0.5;
        light.shadow.camera.far = 500;

        // 设置阴影颜色为深灰色
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        light.shadow.bias = -0.002; // 控制阴影位置
        light.shadow.darkness = 0.5; // 控制阴影的深度（深灰色效果）

        scene.add(light);

        const ambientLight = new THREE.AmbientLight(0x404040);
        scene.add(ambientLight);

        const geometry = new THREE.BoxGeometry();
        const material = new THREE.MeshStandardMaterial({ color: '#808080', transparent: true, opacity: 1 });
        const cubes = [];

        function createCube() {
            const cube = new THREE.Mesh(geometry, material);
            const size = Math.random() * 10 + 3;
            cube.scale.set(size, size, size);
            cube.position.x = window.innerWidth / 2 + Math.random() * window.innerWidth;
            cube.position.y = window.innerHeight / 2 + Math.random() * window.innerHeight;
            cube.position.z = (Math.random() - 0.5) * 100;
            cube.castShadow = true; // 允许模型投射阴影
            cube.receiveShadow = true; // 允许模型接收阴影
            cube.userData = {
                speedX: Math.random() * 0.2 + 0.03,
                speedY: Math.random() * 0.2 + 0.03,
                rotationSpeedX: Math.random() * 0.01 - 0.005,
                rotationSpeedY: Math.random() * 0.01 - 0.005
            };
            scene.add(cube);
            cubes.push(cube);
        }

        for (let i = 0; i < 640; i++) {
            createCube();
        }

        camera.position.z = 50;

        function animate() {
            requestAnimationFrame(animate);

            cubes.forEach(cube => {
                cube.position.x -= cube.userData.speedX;
                cube.position.y -= cube.userData.speedY;
                cube.rotation.x += cube.userData.rotationSpeedX;
                cube.rotation.y += cube.userData.rotationSpeedY;

                if (cube.position.x < -window.innerWidth / 2 || cube.position.y < -window.innerHeight / 2) {
                    scene.remove(cube);
                    cubes.splice(cubes.indexOf(cube), 1);
                    createCube();
                }
            });

            renderer.render(scene, camera);
        }

        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
